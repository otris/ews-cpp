<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ews-cpp: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ews-cpp
   &#160;<span id="projectnumber">0.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ews-cpp Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://travis-ci.org/otris/ews-cpp"></a> <a href="https://ci.appveyor.com/project/BenjaminKircher/ews-cpp"></a></p>
<h1>ews-cpp</h1>
<p>A C++11 header-only library for Microsoft Exchange Web Services.</p>
<ul>
<li><a href="#example">Example</a></li>
<li><a href="#documentation">Documentation</a></li>
<li><a href="#overview">Overview</a><ul>
<li><a href="#supported-operations-and-elements">Supported Operations and Elements</a></li>
<li><a href="#supported-authentication-schemes">Supported Authentication Schemes</a></li>
<li><a href="#supported-compilers">Supported Compilers</a></li>
<li><a href="#supported-operating-systems">Supported Operating Systems</a></li>
<li><a href="#supported-microsoft-exchange-server-versions">Supported Microsoft Exchange Server Versions</a></li>
<li><a href="#run-time-dependencies">Run-time Dependencies</a></li>
<li><a href="#dev-dependencies">Dev Dependencies</a></li>
<li><a href="#note-windows-users">Note Windows Users</a></li>
<li><a href="#source-code">Source Code</a></li>
<li><a href="#building">Building</a><ul>
<li><a href="#linux">Linux</a></li>
<li><a href="#windows">Windows</a></li>
<li><a href="#api-docs">API Docs</a></li>
<li><a href="#test-suite">Test Suite</a></li>
</ul>
</li>
<li><a href="#design-notes">Design Notes</a></li>
<li><a href="#api">API</a></li>
</ul>
</li>
<li><a href="#more-ews-resources">More EWS Resources</a></li>
<li><a href="#legal-notice">Legal Notice</a></li>
</ul>
<h1>Example</h1>
<p>You can find a couple of small executable examples in the <a href="https://github.com/otris/ews-cpp/tree/master/examples">examples/</a> folder.</p>
<p>As an appetizer, this is how it looks when you create and send an email message with ews-cpp:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;ews/ews.hpp&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;exception&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;ostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main() {</div><div class="line">    <a class="code" href="namespaceews.html#a9ac69dea278cd5a973a46011e7f39979">ews::set_up</a>();</div><div class="line"></div><div class="line">    <span class="keywordflow">try</span> {</div><div class="line">        <span class="keyword">auto</span> service = <a class="code" href="classews_1_1basic__service.html">ews::service</a>(<span class="stringliteral">&quot;https://example.com/ews/Exchange.asmx&quot;</span>,</div><div class="line">                                    <span class="stringliteral">&quot;ACME&quot;</span>,</div><div class="line">                                    <span class="stringliteral">&quot;myuser&quot;</span>,</div><div class="line">                                    <span class="stringliteral">&quot;mysecret&quot;</span>);</div><div class="line">        <span class="keyword">auto</span> message = <a class="code" href="classews_1_1message.html">ews::message</a>();</div><div class="line">        message.set_subject(<span class="stringliteral">&quot;Test mail from outer space&quot;</span>);</div><div class="line">        std::vector&lt;ews::mailbox&gt; recipients{ <a class="code" href="classews_1_1mailbox.html">ews::mailbox</a>(<span class="stringliteral">&quot;president@example.com&quot;</span>) };</div><div class="line">        message.set_to_recipients(recipients);</div><div class="line">        <span class="keyword">auto</span> text = <a class="code" href="classews_1_1body.html">ews::body</a>(<span class="stringliteral">&quot;ようこそ (Welcome!)\n\nThis is a test.\n&quot;</span>);</div><div class="line">        message.set_body(text);</div><div class="line">        service.<a class="code" href="classews_1_1basic__service.html#ab2df118631f44147efa9849aed99ff67">create_item</a>(message, <a class="code" href="namespaceews.html#a0655e3b004ea81e191e1c42beeee946fafa98cc27838486cd19d8be214a26240a">ews::message_disposition::send_and_save_copy</a>);</div><div class="line">    } <span class="keywordflow">catch</span> (std::exception&amp; exc) {</div><div class="line">        std::cout &lt;&lt; exc.what() &lt;&lt; std::endl;</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="namespaceews.html#ae91af38b0a1d0fd6d7eb7d45b6c8c594">ews::tear_down</a>();</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h1>Documentation</h1>
<p>We host automatically generated API documentation here: <a href="https://otris.github.io/ews-cpp/">otris.github.io/ews-cpp</a>.</p>
<h1>Overview</h1>
<p>EWS is an API that third-party programmers can use to communicate with Microsoft Exchange Server. The API exists since Exchange Server 2007 and is continuously up-dated by Microsoft and present in the latest iteration of the product, Exchange Server 2016.</p>
<p>This library provides a native and platform-independent way to use EWS in your C++ application.</p>
<div class="image">
<img src="ews-overview.png"  width="80%"/>
</div>
<h2>Supported Operations and Elements</h2>
<ul>
<li>Most items are supported: <code>&lt;CalendarItem&gt;</code>, <code>&lt;Message&gt;</code>, <code>&lt;Contact&gt;</code>, <code>&lt;Task&gt;</code>. Note that we still don't support all properties of all of these items. But we're working on it.</li>
<li>We support <code>&lt;CreateItem&gt;</code>, <code>&lt;SendItem&gt;</code>, <code>&lt;FindItem&gt;</code>, <code>&lt;GetItem&gt;</code>, <code>&lt;UpdateItem&gt;</code>, and <code>&lt;DeleteItem&gt;</code> operations.</li>
<li><code>&lt;CreateFolder&gt;</code>, <code>&lt;GetFolder&gt;</code>, <code>&lt;DeleteFolder&gt;</code>, <code>&lt;FindFolder&gt;</code> operations on folders.</li>
<li>Basic support for attachments: <code>&lt;CreateAttachment&gt;</code>, <code>&lt;GetAttachment&gt;</code>, <code>&lt;DeleteAttachment&gt;</code> for file attachments. Note: Item attachments are not supported yet.</li>
<li>Allow someone else to manage your mail and calendar:<ul>
<li>Impersonation. When you have a service process that needs to do regular tasks for a group of mailboxes or every mailbox in a database.</li>
<li>Delegate access. For granting access to individual users. You can add permissions individually to each mailbox and directly modify folder permissions.</li>
</ul>
</li>
<li>Discovering Exchange servers in your network with Autodiscover is supported.</li>
<li>EWS notification operations (<code>&lt;Subscribe&gt;</code>, <code>&lt;GetEvents&gt;</code>, <code>&lt;Unsubscribe&gt;</code>) to inform you about specific item or folder changes are supported.</li>
</ul>
<h2>Supported Authentication Schemes</h2>
<ul>
<li>HTTP basic auth</li>
<li>NTLM</li>
<li>OAuth2 (Client credentials flow)</li>
</ul>
<p>Note: Kerberos is currently not supported but its on the TODO list.</p>
<h3>OAuth2</h3>
<ul>
<li>For using OAuth2 (client credentials flow), the client needs to be registered in the Azure tenant and granted the application permission "FullAccess".</li>
<li>For an example see the file <a href="example/office365_oauth2.cpp">office365_oauth2.cpp</a>.</li>
</ul>
<h2>Supported Compilers</h2>
<ul>
<li>Microsoft Visual Studio since VS 2012</li>
<li>Clang since 3.5<ul>
<li>with libc++ on Mac OS X</li>
<li>with libstdc++ on Linux (Note that libc++ on Linux is not supported)</li>
</ul>
</li>
<li>GCC since 4.8 with libstdc++</li>
</ul>
<h2>Supported Operating Systems</h2>
<ul>
<li>Microsoft Windows 10</li>
<li>macOS starting with 10.12</li>
<li>RHEL 7</li>
<li>Ubuntu starting with 16.04 LTS</li>
</ul>
<h2>Supported Microsoft Exchange Server Versions</h2>
<ul>
<li>Microsoft Exchange Server 2013 SP1</li>
</ul>
<p>However, our goal is to support all Exchange Server versions since 2007.</p>
<h2>Run-time Dependencies</h2>
<p>The only thing you need for ews-cpp to run is <a href="https://curl.haxx.se/">libcurl</a>.</p>
<h2>Dev Dependencies</h2>
<p>If you want to hack on ews-cpp itself you additionally need</p>
<ul>
<li>Git</li>
<li>CMake</li>
<li>Doxygen (optional)</li>
<li>Python 2 or 3 (optional)</li>
</ul>
<h2>Note Windows Users</h2>
<p>You can obtain an up-to-date and easy-to-use binary distribution of libcurl from here: <a href="http://www.confusedbycode.com/curl/">confusedbycode.com/curl</a></p>
<p>Additionally, you probably need to tell CMake where to find it. Just set <code>CMAKE_PREFIX_PATH</code> to the path where you installed libcurl (e.g. <code>C:\Program Files\cURL</code>) and re-configure.</p>
<p>You can also use the Windows batch script provided in <code>scripts\build-curl.bat</code> to download and compile libcurl for your particular version of Visual Studio.</p>
<h2>Source Code</h2>
<p>ews-cpp's source code is available as a Git repository. To obtain it, type:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;git clone --recursive https://github.com/otris/ews-cpp.git</div></div><!-- fragment --><h2>Building</h2>
<h3>Linux</h3>
<p>The library is header-only. So there is no need to build anything. Just copy the <code>include/ews/</code> directory wherever you may like.</p>
<p>To build the accompanied tests with debugging symbols and Address Sanitizer enabled do something like this:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cmake -DCMAKE_BUILD_TYPE=Debug -DENABLE_SANITIZERS=ON /path/to/source</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;make</div></div><!-- fragment --><p>Type <code>make edit_cache</code> to see all configuration options. <code>make help</code> shows you all available targets.</p>
<h3>Windows</h3>
<p>To build the tests and examples on Windows you can use <code>cmake-gui</code>. For more see: <a href="https://cmake.org/runningcmake/">https://cmake.org/runningcmake/</a></p>
<p>If you do not want to use any GUI to compile the examples and tests you could do something like this with the Windows <code>cmd.exe</code> command prompt:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;set PATH=%PATH%;C:\Program Files (x86)\CMake\bin</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;mkdir builddir</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;cd builddir</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;cmake -G &quot;Visual Studio 14 2015 Win64&quot; ^</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    -DCURL_LIBRARY=&quot;C:\Program Files\cURL\7.49.1\win64-debug\lib\libcurl_debug.lib&quot; ^</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    -DCURL_INCLUDE_DIR=&quot;C:\Program Files\cURL\7.49.1\win64-debug\include&quot; ^</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    C:\path\to\source</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;cmake --build .</div></div><!-- fragment --><p>Make sure to choose the right generator for your environment.</p>
<h3>API Docs</h3>
<p>Use the <code>doc</code> target to create the API documentation with Doxygen. Type:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;make doc</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;open html/index.html</div></div><!-- fragment --><h3>Test Suite</h3>
<p>In order to run individual examples or the test suite export following environment variables like this:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;export EWS_TEST_DOMAIN=&quot;DUCKBURG&quot;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;export EWS_TEST_USERNAME=&quot;mickey&quot;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;export EWS_TEST_PASSWORD=&quot;pluto&quot;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;export EWS_TEST_URI&quot;https://hire-a-detective.com/ews/Exchange.asmx&quot;</div></div><!-- fragment --><p>Be sure to change the values to an actual account on some Exchange server that you can use for testing. Do not run the tests on your own production account.</p>
<p>Once you've build the project, you can execute the tests with:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;./tests --assets=/path/to/source/tests/assets</div></div><!-- fragment --><p>If you do not have any Exchange server available for testing you can run a subset of the tests that do not require a running server like this:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;EWS_TEST_DOMAIN=&quot;&quot; EWS_TEST_USERNAME=&quot;&quot; EWS_TEST_PASSWORD=&quot;&quot; EWS_TEST_URI=&quot;&quot; ./tests \</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    --assets=$HOME/src/ews-cpp/tests/assets \</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    --gtest_filter=Offline\*.\*</div></div><!-- fragment --><h2>Design Notes</h2>
<p>ews-cpp is written in a "modern C++" way:</p>
<ul>
<li>C++ Standard Library, augmented with rapidxml for XML parsing</li>
<li>Smart pointers instead of raw pointers</li>
<li>Pervasive RAII idiom</li>
<li>Handle errors using C++ exceptions</li>
<li>Coding conventions inspired by Boost</li>
</ul>
<h2>API</h2>
<p>Just add:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;ews/ews.hpp&gt;</span></div></div><!-- fragment --><p>to your include directives and you are good to go.</p>
<p>Take a look at the <code>examples/</code> directory to get an idea of how the API feels. ews-cpp is a thin wrapper around Microsoft's EWS API. You will need to refer to the <a href="https://msdn.microsoft.com/en-us/library/office/bb204119%28v=exchg.150%29.aspx">EWS reference for Exchange</a> for all available parameters to pass and all available attributes on items. From 10.000ft it looks like this:</p>
<div class="image">
<img src="ews-objects.png"  width="80%"/>
</div>
<p>You have items and you have <b>the</b> service. You use the service whenever you want to talk to the Exchange server.</p>
<p>Please note one important caveat though. ews-cpp's API is designed to be "blocking". This means whenever you call one of the service's member functions to talk to an Exchange server that call blocks until it receives a request from the server. And that may, well, just take forever (actually until a timeout is reached). You need to keep this in mind in order to not block your main or UI thread.</p>
<p>Implications of this design choice</p>
<p>Pros:</p>
<ul>
<li>A blocking API is much easier to use and understand</li>
</ul>
<p>Cons:</p>
<ul>
<li>You just might accidentally block your UI thread</li>
<li>You cannot issue thousands of EWS requests asynchronously simply because you cannot spawn thousands of threads in your process. You may need additional effort here</li>
</ul>
<h1>More EWS Resources</h1>
<ul>
<li><a href="http://ewseditor.codeplex.com/">EWS Editor</a> is an excellent Open Source tool to test EWS Managed API and do raw SOAP POSTs. Sources are available here: <a href="https://github.com/dseph/EwsEditor">github.com/dseph/EwsEditor</a>.</li>
<li><a href="https://blogs.msdn.microsoft.com/webdav_101/2015/05/11/best-practices-ews-authentication-and-access-issues/">This article</a> on blogs.msdn.microsoft.com describing best practices in EWS Authentication and solving access issues.</li>
</ul>
<h1>Legal Notice</h1>
<p>ews-cpp is developed by otris software AG and was initially released to the public in July 2016. It is licensed under the Apache License, Version 2.0 (see <a href="https://github.com/otris/ews-cpp/blob/master/LICENSE">LICENSE file</a>).</p>
<p>For more information about otris software AG visit our website <a href="https://www.otris.de/">otris.de</a> or our Open Source repositories at <a href="https://github.com/otris">github.com/otris</a>. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
